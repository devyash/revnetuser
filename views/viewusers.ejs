<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rev Net App<</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</head>
<body>

<div class="container">
  <div class="jumbotron">
<h1 align="center"> Users</h1>
</div>
          
  <table class="table table-bordered table-responsive">
    <thead>
        <tr>
            <th width="50px">No</th>
            <th>Name</th>
            <th>Email</th>
            <th>Address</th>
            <th>Speciality</th>
            <th>Delete</th>
        </tr>
        </thead>
        <tbody>
        
  		<% for(var i=0; i<users.length; i++) {%>
         
        <tr>
            <td><%=(i+1)%></td>
            <td><%=users[i].name%></td>
            <td><%=users[i].email%></td>
            <td><%=users[i].address%></td>
            <td><%=users[i].speciality%></td>
            <td><a class="a-inside delete" href="javascript:void(0)" onClick="deleteUser('<%=users[i].email%>')">Delete</a>
               
            </td>
        </tr>
        <% } %>
        </tbody>
        <a href="/"><button type="button" class="btn btn-primary" >Go Back</button></a></body>

<script type="text/javascript">
	    function deleteUser(email){
        console.log(email);
        console.log("Ajax request sent");
    var req=$.ajax({
            url:"/users/delete",
            data: {
		      'email': email,
		    },
            type: 'DELETE',
            success: function(res) {
                
                window.location.reload();
                return true;
            },
            error:function(xhr, status, error){
            
                console.log(xhr.responseText);
                alert("Error deleting");
                return false;
            }
        });
    console.log(req);
    }

</script>
</script>
</html>

